/*! For license information please see bundle.1027b0bd9efe0508d89d.js.LICENSE.txt */
"use strict";(self.webpackChunkhospital_management_frontend=self.webpackChunkhospital_management_frontend||[]).push([[67],{67(e,t,r){r.r(t),r.d(t,{default:()=>O});var n=r(6540),a=r(9210),s=r(322),i=r(5468),o=r(5744),l=r(7548),c=r(4848);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function s(r,n,a,s){var l=n&&n.prototype instanceof o?n:o,c=Object.create(l.prototype);return f(c,"_invoke",function(r,n,a){var s,o,l,c=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,r){return s=t,o=0,l=e,f.n=r,i}};function m(r,n){for(o=r,l=n,t=0;!d&&c&&!a&&t<u.length;t++){var a,s=u[t],m=f.p,p=s[2];r>3?(a=p===n)&&(l=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=e):s[0]<=m&&((a=r<2&&m<s[1])?(o=0,f.v=n,f.n=s[1]):m<p&&(a=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,f.n=p,o=0))}if(a||r>1)return i;throw d=!0,n}return function(a,u,p){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),o=u,l=p;(t=o<2?e:l)||!d;){s||(o?o<3?(o>1&&(f.n=-1),m(o,l)):f.n=l:f.v=l);try{if(c=2,s){if(o||(a="next"),t=s[a]){if(!(t=t.call(s,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=s.return)&&t.call(s),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);s=e}else if((t=(d=f.n<0)?l:r.call(n,f))!==i)break}catch(t){s=e,o=1,l=t}finally{c=1}}return{value:t,done:d}}}(r,a,s),!0),c}var i={};function o(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(f(t={},n,function(){return this}),t),m=c.prototype=o.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,f(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=c,f(m,"constructor",c),f(c,"constructor",l),l.displayName="GeneratorFunction",f(c,a,"GeneratorFunction"),f(m),f(m,a,"Generator"),f(m,n,function(){return this}),f(m,"toString",function(){return"[object Generator]"}),(d=function(){return{w:s,m:p}})()}function f(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}f=function(e,t,r,n){function s(t,r){f(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},f(e,t,r,n)}function m(e,t,r,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var s=e.apply(t,r);function i(e){m(s,n,a,i,o,"next",e)}function o(e){m(s,n,a,i,o,"throw",e)}i(void 0)})}}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){x(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function x(e,t,r){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var b=[{value:"PATIENT",label:"All Patients"},{value:"DOCTOR",label:"All Doctors"},{value:"ALL",label:"Everyone (All Users)"}],j=[{value:"SYSTEM",label:"System"},{value:"ADMIN",label:"Admin"}],w=["All","Unread"],N={APPOINTMENT:"primary",SYSTEM:"warning",ADMIN:"danger"},k=function(e){var t=e.onSuccess,r=y((0,n.useState)({role:"PATIENT",title:"",message:"",type:"ADMIN"}),2),i=r[0],o=r[1],l=y((0,n.useState)(!1),2),u=l[0],f=l[1],m=y((0,n.useState)(null),2),h=m[0],g=m[1],w=function(e){var t=e.target,r=t.name,n=t.value;o(function(e){return v(v({},e),{},x({},r,n))})},N=function(){var e=p(d().m(function e(r){var n,s,l,c;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.preventDefault(),g(null),i.title.trim()&&i.message.trim()){e.n=1;break}return g({type:"error",message:"Title and message are required"}),e.a(2);case 1:if(e.p=1,f(!0),"ALL"!==i.role){e.n=4;break}return e.n=2,a.Er.sendBroadcast(v(v({},i),{},{role:"PATIENT"}));case 2:return e.n=3,a.Er.sendBroadcast(v(v({},i),{},{role:"DOCTOR"}));case 3:g({type:"success",message:"Broadcast sent to all patients and doctors!"}),e.n=6;break;case 4:return e.n=5,a.Er.sendBroadcast(i);case 5:s=e.v,g({type:"success",message:(null===(n=s.data)||void 0===n?void 0:n.message)||"Broadcast sent successfully!"});case 6:o({role:"PATIENT",title:"",message:"",type:"ADMIN"}),null==t||t(),e.n=8;break;case 7:e.p=7,c=e.v,g({type:"error",message:(null===(l=c.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message)||"Failed to send broadcast"});case 8:return e.p=8,f(!1),e.f(8);case 9:return e.a(2)}},e,null,[[1,7,8,9]])}));return function(t){return e.apply(this,arguments)}}();return(0,c.jsxs)(s.Zp,{children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,c.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center",children:(0,c.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Broadcast Notification"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Send a notification to multiple users at once"})]})]}),h&&(0,c.jsx)(s.Fc,{type:h.type,message:h.message,onClose:function(){return g(null)},className:"mb-4"}),(0,c.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsx)(s.l6,{label:"Target Audience",name:"role",value:i.role,onChange:w,options:b}),(0,c.jsx)(s.l6,{label:"Notification Type",name:"type",value:i.type,onChange:w,options:j})]}),(0,c.jsx)(s.pd,{label:"Title",name:"title",value:i.title,onChange:w,placeholder:"Enter notification title",required:!0}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,c.jsx)("textarea",{name:"message",value:i.message,onChange:w,placeholder:"Enter your notification message...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none",required:!0})]}),(0,c.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"ALL"===i.role?"This will be sent to all patients and doctors":"This will be sent to all ".concat(i.role.toLowerCase(),"s")}),(0,c.jsxs)(s.$n,{type:"submit",loading:u,children:[(0,c.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),"Send Broadcast"]})]})]})]})},S=function(){var e=y((0,n.useState)([]),2),t=e[0],r=e[1],i=y((0,n.useState)(!0),2),o=i[0],l=i[1],u=y((0,n.useState)("All"),2),f=u[0],m=u[1],h=function(){var e=p(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,l(!0),"Unread"!==f){e.n=2;break}return e.n=1,a.nJ.getUnread();case 1:n=e.v,e.n=4;break;case 2:return e.n=3,a.nJ.getAll();case 3:n=e.v;case 4:r((null===(t=n.data)||void 0===t?void 0:t.data)||[]),e.n=6;break;case 5:e.p=5,e.v;case 6:return e.p=6,l(!1),e.f(6);case 7:return e.a(2)}},e,null,[[0,5,6,7]])}));return function(){return e.apply(this,arguments)}}();(0,n.useEffect)(function(){h()},[f]);var x=t.filter(function(e){return!e.is_read}).length,g=function(){var e=p(d().m(function e(t){return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,a.nJ.markAsRead(t);case 1:r(function(e){return e.map(function(e){return e.id===t?v(v({},e),{},{is_read:!0}):e})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=p(d().m(function e(){return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,a.nJ.markAllAsRead();case 1:r(function(e){return e.map(function(e){return v(v({},e),{},{is_read:!0})})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),j=function(){var e=p(d().m(function e(t){return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,a.nJ.delete(t);case 1:r(function(e){return e.filter(function(e){return e.id!==t})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}();return(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:(0,c.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"My Notifications"}),x>0&&(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:[x," unread notification",1!==x?"s":""]})]})]}),x>0&&(0,c.jsx)(s.$n,{variant:"secondary",size:"sm",onClick:b,children:"Mark All as Read"})]}),(0,c.jsx)("div",{className:"flex gap-2 border-b border-gray-200",children:w.map(function(e){return(0,c.jsx)("button",{onClick:function(){return m(e)},className:"px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ".concat(f===e?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"),children:e},e)})}),o?(0,c.jsx)(s.aH,{}):0===t.length?(0,c.jsx)(s.Zp,{children:(0,c.jsx)(s.pp,{title:"No notifications",description:"Unread"===f?"You're all caught up!":"You have no notifications yet."})}):(0,c.jsx)("div",{className:"space-y-3",children:t.map(function(e){return(0,c.jsx)(s.Zp,{className:"relative ".concat(e.is_read?"":"bg-primary-50 border-primary-200"),children:(0,c.jsxs)("div",{className:"flex items-start gap-4",children:[!e.is_read&&(0,c.jsx)("span",{className:"mt-2 w-2 h-2 rounded-full bg-primary-600 flex-shrink-0"}),(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,c.jsx)(s.Ex,{variant:N[e.type]||"default",children:e.type}),(0,c.jsx)("span",{className:"text-xs text-gray-400",children:(t=e.created_at,new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}))})]}),(0,c.jsx)("h3",{className:"font-medium text-gray-800",children:e.title}),(0,c.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]}),(0,c.jsxs)("div",{className:"flex gap-2 flex-shrink-0",children:[!e.is_read&&(0,c.jsx)(s.$n,{size:"sm",variant:"secondary",onClick:function(){return g(e.id)},children:"Mark Read"}),(0,c.jsx)(s.$n,{size:"sm",variant:"danger",onClick:function(){return j(e.id)},children:"Delete"})]})]})},e.id);var t})})]})},A=function(e){var t=e.notifications,r=t.length,n=t.filter(function(e){return!e.is_read}).length,a=t.filter(function(e){var t=new Date(e.created_at),r=new Date;return t.toDateString()===r.toDateString()}).length,i=[{label:"Total Notifications",value:r,icon:(0,c.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),color:"blue"},{label:"Unread",value:n,icon:(0,c.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),color:"yellow"},{label:"Today",value:a,icon:(0,c.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}],o={blue:"bg-blue-100 text-blue-600",yellow:"bg-yellow-100 text-yellow-600",green:"bg-green-100 text-green-600"};return(0,c.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:i.map(function(e,t){return(0,c.jsx)(s.Zp,{children:(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(o[e.color]),children:e.icon}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:e.value}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:e.label})]})]})},t)})})};const O=function(){(0,l.As)().user;var e=y((0,n.useState)([]),2),t=e[0],r=e[1],s=y((0,n.useState)(0),2),u=s[0],f=s[1];return(0,n.useEffect)(function(){var e=function(){var e=p(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,a.nJ.getAll();case 1:n=e.v,r((null===(t=n.data)||void 0===t?void 0:t.data)||[]),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();e()},[u]),(0,c.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,c.jsx)(o.A,{}),(0,c.jsxs)("div",{className:"lg:ml-64",children:[(0,c.jsx)(i.A,{}),(0,c.jsx)("main",{className:"p-6",children:(0,c.jsxs)("div",{className:"max-w-5xl space-y-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Notification Management"}),(0,c.jsx)("p",{className:"text-gray-500 mt-1",children:"Send broadcasts and manage your notifications"})]}),(0,c.jsx)(A,{notifications:t}),(0,c.jsx)(k,{onSuccess:function(){f(function(e){return e+1})}}),(0,c.jsx)(S,{},u)]})})]})]})}}}]);